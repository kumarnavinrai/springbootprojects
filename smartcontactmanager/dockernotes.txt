#first install docker desktop
#then pull mysql image mysql:latest
command: docker pull mysql:latest

Then change application.properties file or application.yml file and add these
#database configuration:mysql
spring.datasource.url=jdbc:mysql://${MYSQL_HOST:localhost}:${MYSQL_PORT:3307}/smartcontact
spring.datasource.username=${MYSQL_USER:root}
spring.datasource.password=${MYSQL_PASSWORD:root}

spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

#Then to start mysql container use this command
docker run -p 3307:3306 --name dbcontcm -e MYSQL_ROOT_PASSWORD=root -e MYSQL_DATABASE=smartcontact mysql:latest

here mysqldbcont is the name of mysql container
and we are setting the password for  root user and setting user as root also setting a database name

#now go to the spring boot project root and create Docker file like this
#also you need to generate the .jar file and get its location jar file can be generated by building the project of spring boot

FROM openjdk:17
ADD classes/artifacts/BOOTRESTBOOK_jar/BOOTRESTBOOK.jar bookstore-docker-compose.jar
ENTRYPOINT ["java","-jar","bookstore-docker-compose.jar"]

#once all above steps are done you need to click in itelij idea where play button is near to 3 dots near to a bulb near to right top corner
and click on edit configuration click on modify option and in modify option list
you need to select ADD VM option
and then in build and run section second line you write

#-DMYSQL_USER=root -DMYSQL_PASSWORD=root -DMYSQL_PORT=3307

#then you create a network and attatch both springbootcode container and mysql container to this network
command: docker network create smysql-network

Now network is created and need to connect mysqldb container to this network


#now create the image od docker spring code with the docker file you wrote at the root of the project
Now you move to root of the project
and give command
command: docker build -t springboot-mysql-docker .     [remember this is image not the container]

#Then on right and side to maven option and click on maven goals then give command mvn install

#now need to connect docker mysql container to network
#to see the list on containers running the command is : docker ps
#from here you can see the name of the container

#to see the list of networks you can use the command is : docker network ls

#command to connect mysql container to net is
#command : docker network connect smysql-network mysqldbcont

#to see the state of network or status
#command : docker inspect smysql-network

#now you need to give command to start a spring boot code container and add this container to same network where mysql is connected
#command : docker run -p 9090:8080 --name rest-api-docker --net restapi-network -e MYSQL_HOST=mysqldbcont -e MYSQL_USER=root -e MYSQL_PASSWORD=root -e MYSQL_PORT=3307 rest-api-docker
#command : docker run -p 9090:8080 --name [image name] --net [network name] -e MYSQL_HOST=[mysql container]

#AFTER EXECUTING BELOW COMMAND THE PROJECT IS RUNNING INTERNAL TO MYSQL SO NEED TO USE INTERNAL PORT 3306

docker run -p 9090:8080 --name springboot-mysql-docker --net smysql-network -e MYSQL_HOST=mysqldbcont -e MYSQL_USER=root -e MYSQL_PASSWORD=root -e MYSQL_PORT=3306 springboot-mysql-docker

